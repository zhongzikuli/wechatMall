function openIndicator(){$.showIndicator(),isIndicator=!0}function hideIndicator(){isIndicator&&($.hideIndicator(),isIndicator=!1),loading=!1}$(document).ready(function(){var e=getLocalSession("openid")||"",s=getLocalSession("custId")||"";if(""==e||""==s)return $.toast("未获取到用户资料，无法访问"),void xhq.gotoErrorPage();openIndicator();var t=JSON.parse(getLocalSession("address_edit"));t&&($("#addressId").val(t.addressId),$("#phoneNo").val(t.phoneNo),$("#address").val(t.address),$("#addressName").val(t.addressName),1==t.defaultFlag&&$("#set_address").find("img").attr("src","../img/ico_xuanze.png"),null==t.country||""==t.country?($("#city-picker").val(t.province+" "+t.city+" "),$("#address").val(t.address)):($("#city-picker").val(t.province+" "+t.city+" "+t.country),$("#address").val(t.address)),hideIndicator())}),$(function(){function e(e){var s={addressId:e.addressId,addressName:e.name,phoneNo:e.phoneNo,province:e.province,city:e.city,country:e.country,address:e.address,defaultFlag:e.defaultFlag};setLocalSession("localAddressSession",JSON.stringify(s))}$.init(),$(document).on("click",".confirm-ok",function(){$.confirm("确定要删除地址吗？",function(){var e=$("#addressId").val(),s={interId:"toc.delCustAddress",channel:"C",addressId:e};xhq.__runXHQ(s,function(s){if(0==s.status){var t=getLocalSession("localAddressSession");if(null!=t&&t.length>0){var a=JSON.parse(t);a.addressId==e&&setLocalSession("localAddressSession","")}var n=xhq.getQuery("pageType")||"";xhq.gotoUrl("address_list.html",{pageType:n})}else hideIndicator(),$.toast(s.message)})})}),$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"> <button id="cancel" class="button button-link pull-left">取消</button>  <button class="button button-link pull-right close-picker">完成</button><h1 class="title"></h1> </header>'}),$(document).on("click","#cancel",function(){console.log($(this).parents(".picker-modal")),$(this).parents(".picker-modal").css(" display","none")}),$("#set_address").click(function(){"../img/ico_weixuanze.png"==$(this).find("img").attr("src")?$(this).find("img").attr("src","../img/ico_xuanze.png"):$(this).find("img").attr("src","../img/ico_weixuanze.png")}),$("#baocun").click(function(){var s={},t=$("#city-picker").val();if(t=t.split(" "),s.province=t[0],s.city=t[1],(t.length=3)&&(s.country=t[2]),s.custId=getLocalSession("custId"),s.addressId=$("#addressId").val(),s.name=$("#addressName").val(),s.phoneNo=$.trim($("#phoneNo").val()),""==s.phoneNo)return void $.toast("手机号码不能为空");var a=/^[0-9]+.?[0-9]*$/;return a.test(s.phoneNo)?11!=s.phoneNo.length?void $.toast("手机号码长度不正确，请检查"):/[\u4E00-\u9FA5]{2,5}(?:·[\u4E00-\u9FA5]{2,5})*/i.test(s.name)?s.name.length>5||s.name.length<1?void $.toast("名字不能超过4个汉字不能少于2个汉字"):null==$("#address").val()||""==$("#address").val()?void $.toast("地址不能为空"):(s.address=$("#address").val(),"../img/ico_weixuanze.png"==$("#set_address").find("img").attr("src")?s.defaultFlag=0:s.defaultFlag=1,s.interId="toc.updateCustAddress",s.channel="C",void xhq.__runXHQ(s,function(t){if(0==t.status){var a=xhq.getQuery("pageType")||"";"2"==a&&e(s),xhq.gotoUrl("address_list.html",{pageType:a})}else $.toast(t.message)})):void $.toast("名字不能超过4个汉字不能少于2个汉字"):void $.toast("手机号码格式不正确")})});