var fromCustId,custId;$(function(){function t(){var t={interId:"toc.delUserAddressByCustId",channel:"C",custId:custId};xhq.__runXHQ(t,function(t){0==t.status||($.hideIndicator(),$.toast(t.message))})}if(fromCustId=xhq.getQuery("fromCustId")||0,0==fromCustId)return void xhq.gotoErrorPage();if(custId=getLocalSession("custId"),0==custId)return void xhq.gotoErrorPage();$.showIndicator();var o={interId:"toc.getCustInfoByInvitecode",channel:"C",fromCustId:fromCustId};xhq.__runXHQ(o,function(t){0==t.status&&void 0!=t.body&&null!=t.body&&t.body.custId>0?(document.title=t.body.nickName+"邀请您开店",$("#sharerName1").html(t.body.nickName||"暂无昵称"),$("#sharerImg").attr("src",t.body.headimgUrl||DEFAULT_HEADIMG),$.hideIndicator()):($.hideIndicator(),xhq.gotoErrorPage())}),$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"> <button id="cancel" class="button button-link pull-left">取消</button>  <button class="button button-link pull-right close-picker">完成</button><h1 class="title"></h1> </header>'}),$("#btnGetCode").on("tap",function(t){var o=$.trim($("#newPhoneNo").val());xhq.tobGetVerificationCode($(this),o,function(){$.toast("验证码已发送")})}),$("#buttonPay").on("tap",function(o){var e=$.trim($("#newPhoneNo").val()),n=$.trim($("#verficode").val()),r=$.trim($("#userName").val()),i=$.trim($("#addressDetail").val()),a=$("#city-picker").val();a=a.split(" ");var d=a[0],s=a[1],u="";if((a.length=3)&&(u=a[2]),null==e||""==e)return void $.toast("手机号码未录入");if(11!=e.length)return void $.toast("手机号码长度不正确，请检查");if(null==n||""==n)return void $.toast("验证码未录入");if(4!=n.length)return void $.toast("验证码长度为4位，请检查");if(""==r||null==r)return void $.toast("用户姓名未录入");if(""==a||null==a)return void $.toast("省市县未录入");if(""==i||null==i)return void $.toast("用户详细地址未未录入");$.showIndicator();var c={interId:"toc.registerCust",channel:"C",custId:custId,fromCustId:fromCustId,phoneNo:e,verificationCode:n,userName:r,province:d,city:s,country:u,addressDetail:i};xhq.__runXHQ(c,function(o){if(0==o.status){var e={};e.appId=o.body.appId,e.nonceStr=o.body.nonceStr.toString(),e["package"]=o.body.packageInfo,e.paySign=o.body.paySign,e.timeStamp=o.body.timeStamp+"",xhq.wxPay(e,function(t){$.hideIndicator(),setLocalSession("userType",2),xhq.gotoUrl("open_end.html")},function(){$.hideIndicator(),t(),$.toast("支付失败")})}else $.hideIndicator(),$.toast(o.message)})})});