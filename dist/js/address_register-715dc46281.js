$(function(){function e(){var e=$("#addressName").val()||"",t=$("#phoneNo").val()||"",o=$("#city-picker").val()||"",n=$("#address").val()||"";""!=e&&""!=t&&""!=o&&""!=n&&$("#baocun").css("background-color","rgb(222, 63, 55)")}function t(e){var t={addressId:e.body.id,addressName:e.body.name,phoneNo:e.body.phoneNo,province:e.body.province,city:e.body.city,country:e.body.country,address:e.body.address,defaultFlag:e.body.defaultFlag};setLocalSession("localAddressSession",JSON.stringify(t))}$.init(),$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button id="cancel" class="button button-link pull-left">取消</button>  <button class="button button-link pull-right close-picker">确定</button></header>'}),$(document).on("click","#cancel",function(){console.log($(this).parents(".picker-modal")),$(this).parents(".picker-modal").css(" display","none")});var o=0;$("#set_address").click(function(){"../img/ico_weixuanze.png"==$(this).find("img").attr("src")?($(this).find("img").attr("src","../img/ico_xuanze.png"),o=1):($(this).find("img").attr("src","../img/ico_weixuanze.png"),o=0)}),$("#addressName").on("change",$("#addressName"),function(){e()}),$("#phoneNo").on("change",$("#phoneNo"),function(){e()}),$("#city-picker").on("change",$("#city-picker"),function(){e()}),$("#address").on("change",$("#address"),function(){e()}),$("#baocun").click(function(){var e={},o=$("#city-picker").val(),n=o.split(" ");if(e.province=n[0],e.city=n[1],(n.length=3)&&(e.country=n[2]),e.custId=getLocalSession("custId"),e.name=$("#addressName").val(),e.phoneNo=$.trim($("#phoneNo").val()),""==e.phoneNo||null==e.phoneNo)return void $.toast("手机号码不能为空");var a=/^[0-9]+.?[0-9]*$/;return a.test(e.phoneNo)?11!=e.phoneNo.length?void $.toast("手机号码长度不正确，请检查"):/[\u4E00-\u9FA5]{2,5}(?:·[\u4E00-\u9FA5]{2,5})*/i.test(e.name)?e.name.length>4||e.name.length<1?void $.toast("名字不能超过4个汉字不能少于2个汉字"):null==$("#address").val()||""==$("#address").val()?void $.toast("地址不能为空"):(e.address=$("#address").val(),null==$("#city-picker").val()||""==$("#city-picker").val()?void $.toast("省市不能为空"):("../img/ico_weixuanze.png"==$("#set_address").find("img").attr("src")?e.defaultFlag=0:e.defaultFlag=1,e.interId="toc.addCustAddress",e.channel="C",void xhq.__runXHQ(e,function(e){if(0==e.status){var o=xhq.getQuery("type")||"",n=xhq.getQuery("pageType")||"";"2"==o?(t(e),xhq.gotoUrl("order.html",{pageType:n})):(t(e),xhq.gotoUrl("address_list.html",{pageType:n}))}else $.toast(e.message)}))):void $.toast("名字不能超过4个汉字不能少于2个汉字"):void $.toast("手机号码格式不正确")})});