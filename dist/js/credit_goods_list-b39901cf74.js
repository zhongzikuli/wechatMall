function openIndicator(){$.showIndicator(),isIndicator=!0}function hideIndicator(){isIndicator&&($.hideIndicator(),isIndicator=!1)}function gotoExchange(i){xhq.gotoUrl("credit_goods_detail.html",{onlineId:i})}function getItemHtml(i){debug&&console.log("index="+JSON.stringify(i));var o=i.status,n=2==o?"over":"ongoing",e=2==o?"已兑完":"立即兑换",t='onclick="gotoExchange('+i.onlineId+')"';return s='<li><a href="#" class="'+n+'" '+t+'><div class="goods_pic"><img src="'+i.ImageUrl+'" alt=""></div><div class="goods_text">'+i.showName+'</div><div class="goods_price"><div class="pri_num"><span>'+i.salePrice+'</span>积分</div><div class="go_pay">'+e+"</div></div></a></li>",s}function addItems(i,o,n){var e="",t="";debug&&console.log("addItems="+JSON.stringify(i));for(var l=n+1;l<=n+o;l++)for(var a=0;a<=1&&globalIndex<i.length;a++)t=getItemHtml(i[globalIndex++]),e+=t;$(".infinite-scroll-bottom .list-box").append(e)}function setData(i){i.length<=itemsPerLoad&&($.detachInfiniteScroll($(".infinite-scroll")),$(".infinite-scroll-preloader").remove()),addItems(i,itemsPerLoad,0);var o=8;$(document).on("infinite",".infinite-scroll-bottom",function(){loading||(loading=!0,setTimeout(function(){return loading=!1,o>=maxItems||globalIndex>=i.length?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(addItems(i,itemsPerLoad,o),o=$(".list_box li").length,void $.refreshScroller())},1e3))})}function loadData(){openIndicator();var i={interId:"toc.getExchangeList",channel:"C"};xhq.__runXHQ(i,function(i){if(0==i.status){var o=i.body;void 0!=o&&null!=o&&o.length>0?(debug&&console.log(JSON.stringify(i)),void 0!=o&&null!=o&&o.length>0&&setData(i.body)):($.detachInfiniteScroll($(".infinite-scroll")),$(".infinite-scroll-preloader").remove())}else $.toast(i.message);hideIndicator()})}var isIndicator=!1,debug=!0,loading=!1,maxItems=20,itemsPerLoad=6,globalIndex=0;$(function(){loadData(),$.init()});